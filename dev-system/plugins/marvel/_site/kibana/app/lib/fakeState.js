/*! kibana - v3.1.0 - 2014-12-17
 * Copyright (c) 2014 Rashid Khan; Licensed Apache License */

define(["require","lodash","moment"],function(a){var b=a("lodash"),c=a("moment");return function(a){a=b.defaults(a||{},{indices:20,nodes:1,shards:5,replicas:1});var d={_id:(new Date).getTime()+Math.random(),cluster_name:"elasticsearch",version:1,nodes:{},routing_nodes:{unassigned:[],nodes:{}}};b.times(a.nodes,function(a){var b="node_"+(a+1);d.nodes[b]={name:"Node "+(a+1),transport_address:"inet[localhost/127.0.0.1:"+(9300+a)+"]",attributes:{}},d.routing_nodes.nodes[b]=[]});var e=b.keys(d.nodes);d.master_node=e[0];var f=0,g=function(){var b=e[f];return a.nodes>1&&(f<a.nodes-1?f++:f=0),b};return b.times(a.indices,function(e){var f=c().subtract("days",e).format("[logstash-]YYYY.MM.DD");b.times(a.shards,function(c){var e=g();d.routing_nodes.nodes[e].push({state:"STARTED",primary:!0,node:e,relocating_node:null,shard:c,index:f}),b.times(a.replicas,function(){var b=a.nodes<2?"UNASSIGNED":"STARTED",e=a.nodes<2?null:g(),h=a.nodes<2?d.routing_nodes.unassigned:d.routing_nodes.nodes[e];h.push({state:b,primary:!1,node:e,relocating_node:null,shard:c,index:f})})})}),d}});