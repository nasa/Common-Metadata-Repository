/*! kibana - v3.1.0 - 2014-12-17
 * Copyright (c) 2014 Rashid Khan; Licensed Apache License */

define("panels/marvel/save/lib/save",["config","angular"],function(){var a=require("config"),b=require("angular");return function(c,d){var e=a.elasticsearch+"/"+a.kibana_index+"/dashboard/"+d.current.base.id,f={user:"guest",group:"guest",title:d.current.title,dashboard:b.toJson(d.current)};return c.put(e,f).then(function(a){return a.data})}}),define("panels/marvel/save/module",["require","angular","app","lodash","./lib/save"],function(a){var b=a("angular"),c=a("app"),d=a("lodash"),e=a("./lib/save"),f=b.module("kibana.panels.marvel.save",[]);c.useModule(f),f.controller("marvel.reset",["$scope","dashboard","$routeParams","$location","$timeout",function(a,b,c,d,e){a.reset=function(){var a=b.current.base.link;b.elasticsearch_delete(c.kbnId).then(function(){e(function(){d.path(a)},1e3)})},a.init=function(){a.saved="elasticsearch"===c.kbnType&&b.current.base}}]),f.controller("marvel.save",["$scope","dashboard","kbnVersion","$routeParams","alertSrv","$location","$http",function(a,b,c,f,g,h,i){a.panelMeta={status:"Stable",description:"A simple panel for saving a Marvel dashboard"},a.panel={},a.save=function(){"script"!==f.kbnType&&e(i,b).then(function(a){h.path("/dashboard/elasticsearch/"+a._id),d.isUndefined(a._id)?g.set("Save failed","Dashboard could not be saved to Elasticsearch","error",5e3):g.set("Dashboard Saved",'This dashboard has been saved to Elasticsearch as "'+a._id+'"',"success",5e3)})},a.init=function(){var d="file"===f.kbnType,e=/^marvel.+$/.test(f.kbnId);d&&e&&(b.current.base={id:f.kbnId,version:c,link:h.path()}),!d&&b.current.base&&(a.saved=!0)}}])});